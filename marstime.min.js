function pad(a,b){s=a.toString();s.length<b&&(s=("0000000000"+s).slice(-b));return s}function getMonthString(a){return"January February March April May June July August September October November December".split(" ")[a]}function hms(a){var b=(a+24)%24,a=Math.floor(b),c=Math.floor(60*(b-Math.floor(a))),b=Math.floor(60*(60*(b-a)-c));return pad(a,2)+":"+pad(c,2)+":"+pad(b,2)}
function dhms(a){var b=(a+24)%24,c=Math.floor(b),e=Math.floor(a/24),a="";2<=e?a=e.toString()+" days, ":1<=e&&(a=e.toString()+" day, ");e=Math.floor(60*(b-Math.floor(c)));b=Math.floor(60*(60*(b-c)-e));return a+pad(c,2)+":"+pad(e,2)+":"+pad(b,2)}function ms(a){var b=Math.floor(a/60),a=Math.floor(a-60*Math.floor(b));return pad(b,2)+":"+pad(a,2)}
function startFrom(a,b,c,e,h,f){var g=[];diff=c.getTime()-a;s1=diff/(864E5*1.027491252);s2=s1-Math.floor(s1);g.sol=Math.floor(s1);for(a=Local_Mean_Solar_Time(b,e.j2000_ott)+h;24<a;)g.sol+=1,a-=24;void 0!=f&&(g.sol+=f);g.time=hms(a);g.ltst=hms(Local_True_Solar_Time(b,e.j2000_ott)+h);return g}
function timeNow(){var a=new Date,b=[],c=String(String(a).split("(")[1]).split(")")[0];b.utcdate=a.getUTCFullYear()+"-"+pad(a.getUTCMonth()+1,2)+"-"+a.getUTCDate();b.utctime=pad(a.getUTCHours(),2)+":"+pad(a.getUTCMinutes(),2)+":"+pad(a.getUTCSeconds(),2);b.utcmonth=getMonthString(a.getUTCMonth());b.localdate=a.getFullYear()+"-"+pad(a.getMonth()+1,2)+"-"+pad(a.getDate(),2);b.localtime=pad(a.getHours(),2)+":"+pad(a.getMinutes(),2)+":"+pad(a.getSeconds(),2)+" "+c;b.localmonth=getMonthString(a.getMonth());
b.jdut=julian(a.getTime());b.mjd=b.jdut-2400000.5;b.tt_utc=utc_to_tt_offset(b.jdut);b.jday_tt=julian_tt(b.jdut);b.j2000_ott=j2000_offset_tt(b.jday_tt);b.msd=Mars_Solar_Date(b.j2000_ott);b.mtc=hms(Coordinated_Mars_Time(b.j2000_ott));b.ls=Mars_Ls(b.j2000_ott).toFixed(2);b.lsstring=Mars_Ls_String(b.ls);c=east_to_west(137.440247);b.spirit=startFrom(1073137591E3,184.5215,a,b,-41/60-53/3600,1);b.opportunity=startFrom(1075038391E3,0,a,b,-61/60-6/3600,1);b.curiosity=startFrom(1344174593E3,c,a,b,0,0);b.lightdistance=
ms(499.005215*heliocentric_distance(b.j2000_ott));return b};function protected_mod(a,b){return 0>a?(a-Math.floor(a/b)*b)%b:a%b}function west_to_east(a){east=360-a;return protected_mod(east,360)}function east_to_west(a){return west_to_east(a)}function j2000_epoch(){return 2451545}function mills(){d=new Date;return d.getTime()}function julian(a){return 2440587.5+a/864E5}
function utc_to_tt_offset(a){for(var b=[-2441318.5,0,182,366,731,1096,1461,1827,2192,2557,2922,3469,3834,4199,4930,5844,6575,6940,7487,7852,8217,8766,9313,9862,12419,13515,14792],c=0;c<b.length;c++)b[c]+=2441317.5;for(var e=[-32.184,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],c=0;c<e.length;c++)e[c]+=32.184;if(a>b[b.length-1])c=b.length-1;else if(a<b[0])c=0;else for(c=0;c<b.length-2&&!(a>b[c]&&a<b[c+1]);c++);return e[c]}
function julian_tt(a){return a+utc_to_tt_offset(a)/86400}function j2000_offset_tt(a){return a-j2000_epoch()}function Mars_Mean_Anomaly(a){return protected_mod(19.387+0.52402075*a,360)}function FMS_Angle(a){return protected_mod(270.3863+0.5240384*a,360)}
function alpha_perturbs(a){for(var b=[0.0071,0.0057,0.0039,0.0037,0.0021,0.0020,0.0018],c=[2.2353,2.7543,1.1177,15.7866,2.1354,2.4694,32.8493],e=[49.409,168.173,191.837,21.736,15.704,95.528,49.095],h=0,f=0;f<b.length;f++)h+=b[f]*Math.cos((0.985626*a/c[f]+e[f])*Math.PI/180);return h}function equation_of_center(a){var b=Mars_Mean_Anomaly(a)*Math.PI/180,c=alpha_perturbs(a);return(10.691+3E-7*a)*Math.sin(b)+0.623*Math.sin(2*b)+0.05*Math.sin(3*b)+0.0050*Math.sin(4*b)+5E-4*Math.sin(5*b)+c}
function Mars_Ls_String(a){var b=[0,30,60,90,120,150,180,210,240,270,300,330],c;for(c=0;c<b.length-2&&!(a>b[c]&&a<b[c+1]);c++);return"Early NH Spring;NH Spring;Late NH Spring;Early NH Summer;NH Summer;Late NH Summer;Early NH Fall;NH Fall;Late NH Fall;Early NH Winter;NH Winter;Late NH Winter".split(";")[c]}function Mars_Ls(a){var b=FMS_Angle(a),a=equation_of_center(a);return b=protected_mod(b+a,360)}
function equation_of_time(a){var b=Mars_Ls(a)*Math.PI/180;return 2.861*Math.sin(2*b)-0.071*Math.sin(4*b)+0.0020*Math.sin(6*b)-equation_of_center(a)}function j2000_from_Mars_Solar_Date(a){return 1.027491252*(a+9.6E-4-44796)+4.5}function j2000_ott_from_Mars_Solar_Date(a){a=j2000_from_Mars_Solar_Date(a);return julian_tt(a+j2000_epoch())-j2000_epoch()}function Mars_Solar_Date(a){return(a-4.5)/1.027491252+44796-9.6E-4}function Clancy_Year(a){return Math.floor(1+(a- -16336.0416)/686.978)}
function Mars_Year(a){jday_vals=[-16336.044076,-15649.093471,-14962.0892946,-14275.0960023,-13588.1458658,-12901.1772635,-12214.2082215,-11527.2637345,-10840.2842249,-10153.2828749,-9466.3114025,-8779.3356111,-8092.3607738,-7405.4236452,-6718.4615347,-6031.4574604,-5344.4876509,-4657.5318339,-3970.5474528,-3283.5848372,-2596.6329362,-1909.6426682,-1222.6617049,-535.7040268,151.2736522,838.2369682,1525.1834712,2212.1799182,2899.1848518,3586.1403058,4273.1024234,4960.0765368,5647.0207838,6333.986502,
7020.9875066,7707.9629132,8394.9318782,9081.9102062,9768.8526533,10455.8028354,11142.8050514,11829.7873254,12516.7417734,13203.725449,13890.6991502,14577.6484912,15264.6324865,15951.6217969,16638.5798914,17325.5517216,18012.5209097,18699.4628887,19386.4443201,20073.4534421,20760.4152811,21447.3696661,22134.3466251,22821.2966642,23508.2529432,24195.2539572,24882.2400506,25569.2081296,26256.1902459,26943.1429481,27630.0847446,28317.0793316,29004.0710936,29691.0238241,30377.9991486,31064.9784277,31751.9249377,
32438.896907,33125.8902412,33812.8520242,34499.8183442,35186.7944595,35873.740573,36560.7112423,37247.7247318];year_vals=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79];year_length=[686.95252,686.950605,687.0041764,686.9932923,686.9501365,686.9686023,686.969042,686.944487,686.9795096,687.00135,686.9714724,686.9757914,
686.9748373,686.9371286,686.9621105,687.0040743,686.9698095,686.955817,686.9843811,686.9626156,686.951901,686.990268,686.9809633,686.9576781,686.977679,686.963316,686.946503,686.996447,687.0049336,686.955454,686.9621176,686.9741134,686.944247,686.9657182,687.0010046,686.9754066,686.968965,686.978328,686.9424471,686.9501821,687.002216,686.982274,686.954448,686.9836756,686.9737012,686.949341,686.9839953,686.9893104,686.9580945,686.9718302,686.9691881,686.941979,686.9814314,687.009122,686.961839,686.954385,
686.976959,686.9500391,686.956279,687.001014,686.9860934,686.968079,686.9821163,686.9527022,686.9417965,686.994587,686.991762,686.9527305,686.9753245,686.9792791,686.94651,686.9719693,686.9933342,686.961783,686.96632,686.9761153,686.9461135,686.9706693,687.0134895];if(a<jday_vals[0])return Math.floor(1+(a-jday_vals[0])/year_length[0]);if(a>jday_vals[jday_vals.length-1])return Math.floor(1+(1-jday_vals[jday_vals.length-1])/year_length[jday_vals.length-1]);for(var b=0,b=0;b<year_vals.length-1&&!(jday_vals[b]<=
a&&jday_vals[b+1]>a);b++);return year_vals[b]}function Coordinated_Mars_Time(a){return a=protected_mod(24*((a-4.5)/1.027491252+44796-9.6E-4),24)}function Local_Mean_Solar_Time(a,b){var c=Coordinated_Mars_Time(b)-a*(24/360);return c=protected_mod(c,24)}function Local_True_Solar_Time(a,b){var c=equation_of_time(b),c=Local_Mean_Solar_Time(a,b)+c*(24/360);return c=protected_mod(c,24)}
function subsolar_longitude(a){var b=Coordinated_Mars_Time(a),a=24*equation_of_time(a)/360;return protected_mod(15*(b+a)+180,360)}function solar_declination(a){a=a*Math.PI/180;a=Math.asin(0.42565*Math.sin(a))+0.25*(Math.PI/180)*Math.sin(a);return a=180*a/Math.PI}function heliocentric_distance(a){a=Mars_Mean_Anomaly(a)*Math.PI/180;return 1.523679*(1.00436-0.09309*Math.cos(a)-0.004336*Math.cos(2*a)-3.1E-4*Math.cos(3*a)-3E-5*Math.cos(4*a))}
function heliocentric_longitude(a){var b=Mars_Ls(a),a=b+85.061-0.015*Math.sin((71+2*b)*Math.PI/180)-5.5E-6*a;return protected_mod(a,360)}function heliocentric_latitude(a){var b=Mars_Ls(a);return-(1.8497-2.23E-5*a)*Math.sin((b-144.5+2.57E-6*a)*Math.PI/180)}function hourangle(a,b){var c=subsolar_longitude(b)*Math.PI/180;return a*Math.PI/180-c}
function solar_zenith(a,b,c){a=hourangle(a,c);c=Mars_Ls(c);c=solar_declination(c)*Math.PI/180;b=Math.sin(c)*Math.sin(b*Math.PI/180)+Math.cos(c)*Math.cos(b*Math.PI/180)*Math.cos(a);return 180*Math.acos(b)/Math.PI}function solar_elevation(a,b,c){return 90-solar_zenith(a,b,c)}function solar_azimuth(a,b,c){a=hourangle(a,c);c=Mars_Ls(c);c=solar_declination(c)*Math.PI/180;b=Math.cos(b)*Math.tan(c)-Math.sin(b)*Math.cos(a);a=Math.sin(a);return protected_mod(360+180*Math.atan2(a,b)/Math.PI,360)};
